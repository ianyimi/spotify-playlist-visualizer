# Next.js SaaS Starter with Convex + Better Auth

A minimal, modern Next.js SaaS starter template with real-time database, type-safe APIs, and production-ready authentication.

## What Makes This Different?

This starter template provides essential features for building SaaS applications:

- **âš¡ Convex Database** - Real-time database with automatic subscriptions, optimistic updates, and edge functions
- **ğŸ” Better Auth** - Modern authentication with Google OAuth, email/password, and Convex integration
- **ğŸ¯ Full Type Safety** - End-to-end TypeScript with auto-generated types from Convex schema
- **ğŸ›¡ï¸ Role-Based Access** - Built-in admin/user roles with session management
- **ğŸ¨ Modern UI** - Tailwind CSS 4 + shadcn/ui components + React 19
- **ğŸ“¦ Minimal & Clean** - No unnecessary dependencies, just the essentials

## Quick Start

```bash
# 1. Use this template
Click "Use this template" on GitHub or clone directly

# 2. Install dependencies
pnpm install

# 3. Set up Convex
npx convex dev

# 4. Set up environment variables
cp .env.example .env
# Edit .env with your secrets

# 5. Start the development server
pnpm dev
```

Visit `http://localhost:3000` to see your app!

## Setup

### Prerequisites

- Node.js 18.x or later
- pnpm (or npm/yarn)
- Convex account (free tier available at [convex.dev](https://convex.dev))
- Google Cloud Platform account (optional, for OAuth authentication)

### 1. Clone and Install Dependencies

```bash
git clone <your-repo-url>
cd next-saas-starter
pnpm install
```

### 2. Setup Convex

```bash
# Login to Convex (creates account if needed)
npx convex login

# Initialize Convex in this project
npx convex dev
```

This will:
- Create a new Convex project
- Generate your `CONVEX_DEPLOYMENT` and `NEXT_PUBLIC_CONVEX_URL` environment variables
- Start the Convex dev server
- Watch for changes to your Convex functions

### 3. Setup Google OAuth (Better Auth)

1. Go to the [Google Cloud Console](https://console.cloud.google.com/)
2. Create a new project or select an existing one
3. Configure OAuth consent screen:
   - Go to "APIs & Services" â†’ "OAuth consent screen"
   - Choose "External" user type
   - Fill in required fields (App name, User support email, Developer contact)
4. Create OAuth 2.0 credentials:
   - Go to "APIs & Services" â†’ "Credentials"
   - Click "Create Credentials" â†’ "OAuth 2.0 Client IDs"
   - Choose "Web application"
   - Set application name (e.g., "Next.js SaaS Starter")
   - **Add authorized redirect URIs**:
     - For development: `http://localhost:3000/api/auth/callback/google`
     - For production: `https://yourdomain.com/api/auth/callback/google`
5. **Copy your credentials**:
   - **Client ID**: Copy this value for `GOOGLE_CLIENT_ID`
   - **Client Secret**: Copy this value for `GOOGLE_CLIENT_SECRET`

### 4. Configure Environment Variables

Create a `.env.local` file in the root directory:

```env
# Convex (auto-generated by npx convex dev)
CONVEX_DEPLOYMENT="your-deployment-url"
NEXT_PUBLIC_CONVEX_URL="https://your-project.convex.cloud"
NEXT_PUBLIC_CONVEX_SITE_URL="https://your-project.convex.site"

# Better Auth
BETTER_AUTH_SECRET="your-better-auth-secret"
NEXT_PUBLIC_BETTER_AUTH_URL="http://localhost:3000"

# Google OAuth
GOOGLE_CLIENT_ID="your-google-client-id"
GOOGLE_CLIENT_SECRET="your-google-client-secret"
```

Generate the `BETTER_AUTH_SECRET` using:
```bash
openssl rand -base64 32
```

### 5. Start Development

In separate terminals, run:

```bash
# Terminal 1: Convex dev server
npx convex dev

# Terminal 2: Next.js dev server
pnpm dev
```

Your app will be available at `http://localhost:3000`

## Features Overview

### Authentication (Better Auth + Convex)

- **Multiple providers**: Google OAuth, Email/Password
- **Role-based access**: Admin and User roles
- **Session management**: Secure sessions stored in Convex
- **Auth pages**: Pre-built sign-in/sign-up flows at `/auth/*`
- **Server-side auth**: Works in Server Components, Server Actions, and API routes

### Real-Time Database (Convex)

- **Automatic subscriptions**: UI updates in real-time when data changes
- **Optimistic updates**: Instant UI feedback with automatic rollback on errors
- **Type-safe queries**: Auto-generated TypeScript types from your schema
- **Edge functions**: Low-latency backend functions deployed globally
- **No migrations**: Schema changes deploy automatically without downtime

### Tech Stack

- **Framework**: Next.js 16 (App Router + Turbopack)
- **Language**: TypeScript 5.8 with strict mode
- **Database**: Convex (real-time database + backend)
- **Auth**: Better Auth 1.3.2 with @convex-dev/better-auth
- **UI**: React 19, Tailwind CSS 4, shadcn/ui
- **Validation**: Zod 4.0
- **Package Manager**: pnpm

## Project Structure

```
/src
â”œâ”€â”€ /app                          # Next.js App Router
â”‚   â”œâ”€â”€ /(frontend)              # Frontend pages and layout
â”‚   â”‚   â”œâ”€â”€ /auth/[pathname]     # Better Auth flow pages
â”‚   â”‚   â””â”€â”€ page.tsx             # Home page
â”‚   â””â”€â”€ /api
â”‚       â””â”€â”€ /auth/[...all]       # Better Auth API routes
â”‚
â”œâ”€â”€ /auth                        # Auth configuration
â”‚   â”œâ”€â”€ client.ts                # Browser auth client
â”‚   â”œâ”€â”€ server.ts                # Server-side token helper
â”‚   â””â”€â”€ utils.ts                 # Server-side auth utilities
â”‚
â”œâ”€â”€ /components                  # React components
â”‚   â”œâ”€â”€ /auth                    # Authentication components
â”‚   â””â”€â”€ /Providers               # Context providers
â”‚
â”œâ”€â”€ /convex                      # Convex backend
â”‚   â”œâ”€â”€ /auth                    # Auth integration
â”‚   â”‚   â”œâ”€â”€ index.ts            # Auth setup
â”‚   â”‚   â”œâ”€â”€ api.ts              # Auth queries
â”‚   â”‚   â””â”€â”€ plugins.ts          # Auth plugins
â”‚   â”œâ”€â”€ schema.ts               # Database schema
â”‚   â”œâ”€â”€ http.ts                 # HTTP routes
â”‚   â””â”€â”€ convex.config.ts        # Convex config
â”‚
â”œâ”€â”€ /db/constants               # Database constants
â”‚   â””â”€â”€ index.ts                # Collection names, roles
â”‚
â””â”€â”€ /ui                         # shadcn/ui components
```

## Usage Patterns

### Client Components

```typescript
'use client'
import { useQuery, useMutation } from 'convex/react'
import { api } from '~/convex/_generated/api'

export function MyComponent() {
  // Real-time reactive query
  const data = useQuery(api.myModule.myQuery)
  const doSomething = useMutation(api.myModule.myMutation)

  return <div>{data?.value}</div>
}
```

### Server Components

```typescript
import { preloadQuery } from 'convex/nextjs'
import { api } from '~/convex/_generated/api'
import { getToken } from '~/auth/server'

export default async function Page() {
  const token = await getToken()
  const preloaded = await preloadQuery(api.myModule.myQuery, {}, { token })

  return <MyClientComponent preloaded={preloaded} />
}
```

### Convex Functions

```typescript
// src/convex/myModule.ts
import { query, mutation } from './_generated/server'
import { authComponent } from './auth'

export const myQuery = query({
  args: {},
  handler: async (ctx) => {
    // Check auth
    const user = await authComponent.getAuthUser(ctx)
    if (!user) throw new Error("Unauthorized")

    // Query data
    return await ctx.db.query("myTable").collect()
  }
})
```

## What's Next?

This starter provides authentication and real-time database already configured. Start building your application features immediately!

### Learn More

- **[Next.js](https://nextjs.org)** - React framework with App Router
- **[Convex](https://convex.dev)** - Real-time database and backend
- **[Better Auth](https://www.better-auth.com/)** - Modern authentication library
- **[Tailwind CSS](https://tailwindcss.com)** - Utility-first CSS framework
- **[shadcn/ui](https://ui.shadcn.com/)** - Re-usable component library

## Deployment

### Deploy to Vercel

The easiest way to deploy is with Vercel:

1. Push your code to GitHub
2. Import your repository to Vercel
3. Add environment variables in Vercel dashboard
4. Deploy!

Convex automatically deploys when you push to your main branch.

### Self-Hosted with SST (Planned)

Future versions will include SST configuration for one-command AWS deployment.

## Documentation

See the `/agent-os` folder for detailed documentation:
- Product mission and roadmap
- Tech stack details
- Development standards and best practices

## License

MIT
